@model IEnumerable<SessionDto>
@using Microsoft.Extensions.Localization
@using StationPro
@inject IStringLocalizer<SharedResources> Localizer

@if (!Model.Any())
{
    <div class="text-center py-12">
        <i class="fas fa-inbox text-gray-300 text-5xl mb-4"></i>
        <p class="text-gray-500 font-medium">@Localizer["NoActiveSessions"]</p>
        <p class="text-gray-400 text-sm mt-2">@Localizer["StartSessionToSee"]</p>
        <button onclick="openModal('start-session-modal')"
                class="btn btn-primary mt-4">
            <i class="fas fa-play mr-2"></i>
            @Localizer["StartSession"]
        </button>
    </div>
}
else
{
    <div class="space-y-3">
        @foreach (var session in Model)
        {
            <div class="bg-gradient-to-r from-red-50 to-orange-50 rounded-lg border-l-4 border-red-500 hover:shadow-md transition-all fade-in overflow-hidden">
                <div class="p-2.5 sm:p-4">
                    <div class="flex flex-col sm:flex-row sm:items-center gap-2.5 sm:gap-4">

                        <!-- Left Section: Device Icon + Info -->
                        <div class="flex items-center gap-2.5 sm:gap-4 flex-1 min-w-0">
                            <div class="bg-red-100 p-2 sm:p-3 rounded-lg flex-shrink-0">
                                <i class="fas fa-gamepad text-red-600 text-base sm:text-xl"></i>
                            </div>

                            <div class="flex-1 min-w-0">
                                <h4 class="font-bold text-gray-900 text-sm sm:text-base truncate">@session.DeviceName</h4>
                                <div class="flex flex-wrap items-center gap-x-2.5 sm:gap-x-4 gap-y-1 text-xs sm:text-sm text-gray-600 mt-0.5">
                                    @if (!string.IsNullOrEmpty(session.CustomerName))
                                    {
                                        <span class="flex items-center gap-1">
                                            <i class="fas fa-user text-[10px] sm:text-xs"></i>
                                            <span class="truncate max-w-[100px] sm:max-w-none">@session.CustomerName</span>
                                        </span>
                                    }
                                    else
                                    {
                                        <span class="flex items-center gap-1">
                                            <i class="fas fa-user-secret text-[10px] sm:text-xs"></i>
                                            @Localizer["Guest"]
                                        </span>
                                    }
                                    <span class="flex items-center gap-1 whitespace-nowrap">
                                        <i class="fas fa-clock text-[10px] sm:text-xs"></i>
                                        <span class="text-[11px] sm:text-xs">@session.StartTime.ToString("h:mm tt")</span>
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Right Section: Timer, Cost & Button -->
                        <div class="flex items-center justify-between sm:justify-end gap-2 sm:gap-4 w-full sm:w-auto">
                            <div class="text-left sm:text-right flex-shrink-0">
                                <div class="font-mono text-base sm:text-xl lg:text-2xl font-bold text-blue-600 leading-tight timer-display-@session.Id"
                                     id="timer-@session.Id"
                                     data-start-time="@session.StartTime.ToString("o")"
                                     data-hourly-rate="@session.HourlyRate">
                                    @session.DurationFormatted
                                </div>

                                <p class="text-sm sm:text-base lg:text-lg font-bold text-green-600 leading-tight cost-display-@session.Id"
                                   id="cost-@session.Id">
                                    @session.TotalCost.ToString("C")
                                </p>

                                <p class="text-[10px] sm:text-xs text-gray-500">
                                    @session.HourlyRate.ToString("C")/@Localizer["hr"]
                                </p>
                            </div>

                            <!-- End Button -->
                            <div class="flex-shrink-0 btn-end-wrapper">
                                <button data-session-id="@session.Id"
                                        onclick="endSessionWithReceipt(this.getAttribute('data-session-id'))"
                                        class="btn btn-danger btn-end-responsive">
                                    <i class="fas fa-stop btn-end-icon"></i>
                                    <span>@Localizer["End"]</span>
                                </button>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        }
    </div>
}
